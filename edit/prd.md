# PRD: Shorts Clip Editor (Edit)

## 1. 제품 개요

### Product Name
**Shorts Clip Editor (SCE)**

### 목적(Objective)
복수의 영상에서 클립 구간을 지정하고, 지정된 규칙(연속 동일 소스 금지)에 따라 자동 편집하여 클립 조합 영상을 생성한다. **영상 비율은 원본 그대로 유지**하며, 최종 편집은 사용자가 직접 수행한다.

### 핵심 가치(Core Value)
- 다중 영상 동시 클립 추출
- 규칙 기반 자동 편집 (연속 동일 소스 방지)
- 커스텀 길이 Shorts 자동 생성
- 브라우저 기반 편집 - 별도 소프트웨어 불필요

---

## 2. 기능 요구사항 (Functional Requirements)

### 2.1 영상 업로드 및 재생

#### Requirement
- 사용자는 3~5개의 영상을 동시에 업로드 가능
- 지원 포맷: MP4, WebM, MOV
- 최대 파일 크기: 500MB (개별)

#### 재생 기능
| Feature | Description |
|---------|-------------|
| 비디오 플레이어 | HTML5 기반, 커스텀 컨트롤 |
| 타임라인 | 영상 하단에 시각적 타임라인 표시 |
| 탐색 | 클릭/드래그로 특정 시점 이동 |
| 재생 속도 | 0.5x, 1x, 1.5x, 2x 지원 |

---

### 2.2 클립 지정 기능

#### Clip Button
- **위치**: 재생 버튼 옆에 "Clip" 버튼 배치
- **동작**: 버튼 클릭 시 현재 시점부터 **1.5초** 구간을 클립으로 지정
- **시각적 피드백**: 지정된 구간을 타임라인에 **반투명 컬러 블록**으로 표시

#### Clip Data Schema
| Field | Type | Description |
|-------|------|-------------|
| `clip_id` | String | 클립 고유 ID (예: a1, a2, b1) |
| `video_id` | String | 소스 영상 식별자 (a, b, c...) |
| `start_time` | Float | 시작 시간 (초) |
| `end_time` | Float | 종료 시간 (start + 1.5초) |
| `duration` | Float | 클립 길이 (1.5초 고정) |

#### 클립 관리
- 각 영상당 **무제한** 클립 생성 가능
- 클립 삭제 기능
- 클립 순서 미리보기

---

### 2.3 편집 규칙 (Editing Rules)

> [!IMPORTANT]
> **연속 동일 소스 금지 규칙**
> 
> 같은 영상에서 추출한 클립은 연속으로 배치될 수 없음
> 
> **허용**: a1 → b1 → c1 → a2 → b2
> **금지**: a1 → a2 → b1 (a1 다음에 a2 연속 불가)

#### Rule Implementation
```
예시:
- 영상 A: 클립 a1, a2, a3
- 영상 B: 클립 b1, b2, b3
- 영상 C: 클립 c1, c2, c3

허용되는 시퀀스:
a1 → b1 → c1 → a2 → b2 → c2 → a3 → b3 → c3

금지되는 시퀀스:
a1 → a2 → b1 (a1 다음에 a2 불가)
b1 → b2 → b3 (b 연속 3개 불가)
```

#### 자동 셔플 알고리즘
1. 모든 클립을 소스별로 그룹화
2. 라운드 로빈 방식으로 각 소스에서 번갈아 가며 선택
3. 한 소스의 클립이 소진되면 남은 소스들로 계속 진행
4. 연속 동일 소스 검증 후 문제 시 재배열

---

### 2.4 Shorts 생성 설정

#### 설정 옵션
| Setting | Type | Range | Default |
|---------|------|-------|---------|
| 최종 영상 길이 | Number | 15~60초 | 30초 |
| 생성할 영상 개수 | Number | 1~10개 | 3개 |
| 출력 포맷 | Select | MP4, WebM | MP4 |

> [!NOTE]
> 영상 비율은 **원본 그대로 유지**됩니다. 세로 비율 변환이 필요한 경우 별도 편집 소프트웨어를 사용하세요.

---

### 2.5 다운로드 기능

#### Requirement
- 개별 클립 다운로드
- 완성된 Shorts 개별 다운로드
- 전체 Shorts 일괄 다운로드 (ZIP)

#### 파일명 규칙
```
shorts_[순번]_[길이]s_[날짜].mp4
예: shorts_01_30s_20260107.mp4
```

---

## 3. UI 요구사항

### 3.1 Navigation
- 기존 YGIF 헤더에 **Edit** 버튼 추가
- 위치: Search와 Download 사이

### 3.2 Edit Page Layout

```
┌─────────────────────────────────────────────────────────────┐
│ Header: YGIF                        [Search][Edit][Download] │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  Upload Area (Drag & Drop or Click)                   │   │
│  │  "Upload 3-5 videos to start editing"                 │   │
│  └──────────────────────────────────────────────────────┘   │
│                                                              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │
│  │  Video A    │  │  Video B    │  │  Video C    │          │
│  │  Thumbnail  │  │  Thumbnail  │  │  Thumbnail  │          │
│  │  [Play]     │  │  [Play]     │  │  [Play]     │          │
│  │  Clips: 3   │  │  Clips: 2   │  │  Clips: 4   │          │
│  └─────────────┘  └─────────────┘  └─────────────┘          │
│                                                              │
├─────────────────────────────────────────────────────────────┤
│                    Active Video Player                       │
│  ┌──────────────────────────────────────────────────────┐   │
│  │                                                        │   │
│  │                    [Video Display]                     │   │
│  │                                                        │   │
│  └──────────────────────────────────────────────────────┘   │
│  [▶ Play] [⏸ Pause] [🎬 Clip]           00:15 / 02:30      │
│  ┌──────────────────────────────────────────────────────┐   │
│  │ ████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ │   │
│  │ ^^Clip   ^^Clip                                       │   │
│  └──────────────────────────────────────────────────────┘   │
│                                                              │
├─────────────────────────────────────────────────────────────┤
│  Clips List                                                  │
│  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐    │
│  │ a1     │ │ a2     │ │ b1     │ │ c1     │ │ c2     │    │
│  │ 0:05   │ │ 0:12   │ │ 0:08   │ │ 0:20   │ │ 0:45   │    │
│  │ [×]    │ │ [×]    │ │ [×]    │ │ [×]    │ │ [×]    │    │
│  └────────┘ └────────┘ └────────┘ └────────┘ └────────┘    │
│                                                              │
├─────────────────────────────────────────────────────────────┤
│  Generation Settings                                         │
│  Shorts Length: [30초 ▼]   Count: [3개 ▼]   Resolution: [▼] │
│                                                              │
│  [ Generate Shorts ]  [ Download All (ZIP) ]                │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 3.3 Clip Indicator
- 타임라인 위 **반투명 컬러 블록**으로 클립 구간 표시
- 각 영상별 고유 색상 (A: 파랑, B: 초록, C: 주황 등)
- 호버 시 클립 ID 및 시간 정보 표시

---

## 4. 기술 스택

### Frontend
| Technology | Purpose |
|------------|---------|
| Next.js (App Router) | 기존 YGIF와 통합 |
| TypeScript | Type Safety |
| TailwindCSS | Styling |
| React Player / HTML5 Video | 비디오 재생 |
| wavesurfer.js (Optional) | 타임라인 시각화 |

### Backend / Processing
| Technology | Purpose |
|------------|---------|
| FFmpeg (WASM) | 브라우저 내 영상 편집 |
| @ffmpeg/ffmpeg | FFmpeg WebAssembly |
| Web Workers | 백그라운드 처리 |
| IndexedDB | 로컬 영상 캐싱 |

---

## 5. 프로젝트 구조

```
youtubesearch/
├── prd.md                    # YouTube Search PRD
├── edit/
│   ├── prd.md               # 이 문서
│   └── [코드 파일들]
└── ygif/
    └── src/
        └── app/
            └── edit/         # Edit 페이지
                └── page.tsx
```

---

## 6. 릴리즈 단계

### MVP
- [ ] Next.js Edit 페이지 생성
- [ ] 다중 영상 업로드
- [ ] 비디오 플레이어 + 타임라인
- [ ] 클립 버튼 및 구간 저장
- [ ] 클립 시각화 (반투명 표시)
- [ ] 연속 동일 소스 금지 알고리즘
- [ ] Shorts 생성 및 다운로드

### v1.1
- [ ] 클립 길이 커스텀 (1.5초 외)
- [ ] 드래그로 클립 순서 조정
- [ ] 미리보기 재생

### v1.2
- [ ] 자동 하이라이트 감지
- [ ] 배경 음악 추가

---

## 7. 성공 KPI

| Metric | Target |
|--------|--------|
| 영상 업로드 성공률 | 99% |
| 클립 추출 정확도 | 100% (±0.1초) |
| Shorts 생성 성공률 | 95% |
| 편집 규칙 준수율 | 100% |

---

## 8. 리스크 관리

| Risk | Mitigation |
|------|------------|
| 대용량 영상 처리 | 클라이언트 메모리 제한, 경고 표시 |
| FFmpeg WASM 호환성 | 지원 브라우저 명시, 폴백 제공 |
| 영상 코덱 미지원 | 지원 포맷 명확히 안내 |
